var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,o=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,r=(e,a)=>{for(var t in a||(a={}))n.call(a,t)&&o(e,t,a[t]);if(l)for(var t of l(a))s.call(a,t)&&o(e,t,a[t]);return e},i=(e,l)=>a(e,t(l));import{a4 as c,bs as u,ay as v,W as d,X as f,bW as p,bu as m,bv as b,m as w,by as g,bz as y,bX as h,k,a as x,Q as z,bG as O,aY as C,al as I,as as _,U as T,a2 as A,b1 as B,A as L,x as j,bp as S,V as N,bJ as V,bP as E,I as M,aI as P,aE as Y,b3 as $,bn as D,C as R,aF as X,b6 as F,T as H,bB as W,cO as Q,cQ as U,bF as G,cU as Z,D as q,ak as J,d6 as K,bH as ee,bT as ae,dP as te,dQ as le}from"./el-button.0a4ba32a.js";import{m as ne}from"./typescript.72bf8adc.js";import{w as se,x as oe,N as re}from"./main.858372aa.js";import{z as ie}from"./zoom-in.dd934e7d.js";import{u as ce}from"./index.c956e740.js";import{u as ue}from"./el-input.b3ba137c.js";const ve=c({name:"FullScreen"}),de={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},fe=[f("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64v.064zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64l-192 .192zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64v-.064z"},null,-1)];var pe=u(ve,[["render",function(e,a,t,l,n,s){return v(),d("svg",de,fe)}]]);const me=c({name:"RefreshLeft"}),be={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},we=[f("path",{fill:"currentColor",d:"M289.088 296.704h92.992a32 32 0 0 1 0 64H232.96a32 32 0 0 1-32-32V179.712a32 32 0 0 1 64 0v50.56a384 384 0 0 1 643.84 282.88 384 384 0 0 1-383.936 384 384 384 0 0 1-384-384h64a320 320 0 1 0 640 0 320 320 0 0 0-555.712-216.448z"},null,-1)];var ge=u(me,[["render",function(e,a,t,l,n,s){return v(),d("svg",be,we)}]]);const ye=c({name:"RefreshRight"}),he={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},ke=[f("path",{fill:"currentColor",d:"M784.512 230.272v-50.56a32 32 0 1 1 64 0v149.056a32 32 0 0 1-32 32H667.52a32 32 0 1 1 0-64h92.992A320 320 0 1 0 524.8 833.152a320 320 0 0 0 320-320h64a384 384 0 0 1-384 384 384 384 0 0 1-384-384 384 384 0 0 1 643.712-282.88z"},null,-1)];var xe=u(ye,[["render",function(e,a,t,l,n,s){return v(),d("svg",he,ke)}]]);const ze=c({name:"ScaleToOriginal"}),Oe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},Ce=[f("path",{fill:"currentColor",d:"M813.176 180.706a60.235 60.235 0 0 1 60.236 60.235v481.883a60.235 60.235 0 0 1-60.236 60.235H210.824a60.235 60.235 0 0 1-60.236-60.235V240.94a60.235 60.235 0 0 1 60.236-60.235h602.352zm0-60.235H210.824A120.47 120.47 0 0 0 90.353 240.94v481.883a120.47 120.47 0 0 0 120.47 120.47h602.353a120.47 120.47 0 0 0 120.471-120.47V240.94a120.47 120.47 0 0 0-120.47-120.47zm-120.47 180.705a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 0 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zm-361.412 0a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 1 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zM512 361.412a30.118 30.118 0 0 0-30.118 30.117v30.118a30.118 30.118 0 0 0 60.236 0V391.53A30.118 30.118 0 0 0 512 361.412zM512 512a30.118 30.118 0 0 0-30.118 30.118v30.117a30.118 30.118 0 0 0 60.236 0v-30.117A30.118 30.118 0 0 0 512 512z"},null,-1)];var Ie=u(ze,[["render",function(e,a,t,l,n,s){return v(),d("svg",Oe,Ce)}]]);const _e=c({name:"ZoomOut"}),Te={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},Ae=[f("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704zM352 448h256a32 32 0 0 1 0 64H352a32 32 0 0 1 0-64z"},null,-1)];var Be=u(_e,[["render",function(e,a,t,l,n,s){return v(),d("svg",Te,Ae)}]]);const Le=m({urlList:{type:b(Array),default:()=>ne([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0}}),je=["src"];const Se=G(W(c(i(r({},{name:"ElImageViewer"}),{props:Le,emits:{close:()=>!0,switch:e=>"number"==typeof e},setup(e,{emit:a}){const t=e,l={CONTAIN:{name:"contain",icon:w(pe)},ORIGINAL:{name:"original",icon:w(Ie)}},n=p&&/firefox/i.test(window.navigator.userAgent)?"DOMMouseScroll":"mousewheel",{t:s}=g(),o=y("image-viewer"),{nextZIndex:c}=h(),u=k(),m=k([]),b=x(),W=k(!0),G=k(t.initialIndex),Z=k(l.CONTAIN),q=k({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),J=z((()=>{const{urlList:e}=t;return e.length<=1})),K=z((()=>0===G.value)),ee=z((()=>G.value===t.urlList.length-1)),ae=z((()=>t.urlList[G.value])),te=z((()=>{const{scale:e,deg:a,offsetX:t,offsetY:n,enableTransition:s}=q.value;let o=t/e,r=n/e;switch(a%360){case 90:case-270:[o,r]=[r,-o];break;case 180:case-180:[o,r]=[-o,-r];break;case 270:case-90:[o,r]=[-r,o]}const i={transform:`scale(${e}) rotate(${a}deg) translate(${o}px, ${r}px)`,transition:s?"transform .3s":""};return Z.value.name===l.CONTAIN.name&&(i.maxWidth=i.maxHeight="100%"),i})),le=z((()=>O(t.zIndex)?t.zIndex:c()));function ne(){b.stop(),a("close")}function ce(){W.value=!1}function ue(e){W.value=!1,e.target.alt=s("el.image.error")}function ve(e){if(W.value||0!==e.button||!u.value)return;q.value.enableTransition=!1;const{offsetX:a,offsetY:t}=q.value,l=e.pageX,n=e.pageY,s=re((e=>{q.value=i(r({},q.value),{offsetX:a+e.pageX-l,offsetY:t+e.pageY-n})})),o=U(document,"mousemove",s);U(document,"mouseup",(()=>{o()})),e.preventDefault()}function de(){q.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function fe(){if(W.value)return;const e=Object.keys(l),a=Object.values(l),t=Z.value.name,n=(a.findIndex((e=>e.name===t))+1)%e.length;Z.value=l[e[n]],de()}function me(){if(K.value&&!t.infinite)return;const e=t.urlList.length;G.value=(G.value-1+e)%e}function be(){if(ee.value&&!t.infinite)return;const e=t.urlList.length;G.value=(G.value+1)%e}function we(e,a={}){if(W.value)return;const{zoomRate:t,rotateDeg:l,enableTransition:n}=r({zoomRate:1.4,rotateDeg:90,enableTransition:!0},a);switch(e){case"zoomOut":q.value.scale>.2&&(q.value.scale=Number.parseFloat((q.value.scale/t).toFixed(3)));break;case"zoomIn":q.value.scale<7&&(q.value.scale=Number.parseFloat((q.value.scale*t).toFixed(3)));break;case"clockwise":q.value.deg+=l;break;case"anticlockwise":q.value.deg-=l}q.value.enableTransition=n}return C(ae,(()=>{I((()=>{const e=m.value[0];(null==e?void 0:e.complete)||(W.value=!0)}))})),C(G,(e=>{de(),a("switch",e)})),_((()=>{var e,a;!function(){const e=re((e=>{switch(e.code){case Q.esc:t.closeOnPressEscape&&ne();break;case Q.space:fe();break;case Q.left:me();break;case Q.up:we("zoomIn");break;case Q.right:be();break;case Q.down:we("zoomOut")}})),a=re((e=>{we((e.wheelDelta?e.wheelDelta:-e.detail)>0?"zoomIn":"zoomOut",{zoomRate:1.2,enableTransition:!1})}));b.run((()=>{U(document,"keydown",e),U(document,n,a)}))}(),null==(a=null==(e=u.value)?void 0:e.focus)||a.call(e)})),(e,a)=>(v(),T(H,{to:"body",disabled:!e.teleported},[A(F,{name:"viewer-fade",appear:""},{default:B((()=>[f("div",{ref_key:"wrapper",ref:u,tabindex:-1,class:L(j(o).e("wrapper")),style:R({zIndex:j(le)})},[f("div",{class:L(j(o).e("mask")),onClick:a[0]||(a[0]=S((a=>e.hideOnClickModal&&ne()),["self"]))},null,2),N(" CLOSE "),f("span",{class:L([j(o).e("btn"),j(o).e("close")]),onClick:ne},[A(j(V),null,{default:B((()=>[A(j(E))])),_:1})],2),N(" ARROW "),j(J)?N("v-if",!0):(v(),d(M,{key:0},[f("span",{class:L([j(o).e("btn"),j(o).e("prev"),j(o).is("disabled",!e.infinite&&j(K))]),onClick:me},[A(j(V),null,{default:B((()=>[A(j(se))])),_:1})],2),f("span",{class:L([j(o).e("btn"),j(o).e("next"),j(o).is("disabled",!e.infinite&&j(ee))]),onClick:be},[A(j(V),null,{default:B((()=>[A(j(oe))])),_:1})],2)],64)),N(" ACTIONS "),f("div",{class:L([j(o).e("btn"),j(o).e("actions")])},[f("div",{class:L(j(o).e("actions__inner"))},[A(j(V),{onClick:a[1]||(a[1]=e=>we("zoomOut"))},{default:B((()=>[A(j(Be))])),_:1}),A(j(V),{onClick:a[2]||(a[2]=e=>we("zoomIn"))},{default:B((()=>[A(j(ie))])),_:1}),f("i",{class:L(j(o).e("actions__divider"))},null,2),A(j(V),{onClick:fe},{default:B((()=>[(v(),T(P(Z.value.icon)))])),_:1}),f("i",{class:L(j(o).e("actions__divider"))},null,2),A(j(V),{onClick:a[3]||(a[3]=e=>we("anticlockwise"))},{default:B((()=>[A(j(ge))])),_:1}),A(j(V),{onClick:a[4]||(a[4]=e=>we("clockwise"))},{default:B((()=>[A(j(xe))])),_:1})],2)],2),N(" CANVAS "),f("div",{class:L(j(o).e("canvas"))},[(v(!0),d(M,null,Y(e.urlList,((e,a)=>$((v(),d("img",{ref_for:!0,ref:e=>m.value[a]=e,key:e,src:e,style:R(j(te)),class:L(j(o).e("img")),onLoad:ce,onError:ue,onMousedown:ve},null,46,je)),[[D,a===G.value]]))),128))],2),X(e.$slots,"default")],6)])),_:3})],8,["disabled"]))}})),[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]])),Ne=m({appendToBody:{type:Boolean,default:void 0},hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},lazy:{type:Boolean,default:!1},scrollContainer:{type:b([String,Object])},previewSrcList:{type:b(Array),default:()=>ne([])},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0}}),Ve={error:e=>e instanceof Event,switch:e=>O(e),close:()=>!0},Ee=["src"],Me={key:0};const Pe=G(W(c(i(r({},{name:"ElImage"}),{props:Ne,emits:Ve,setup(e,{emit:a}){const t=e;let l="";ce({scope:"el-image",from:"append-to-body",replacement:"preview-teleported",version:"2.2.0",ref:"https://element-plus.org/en-US/component/image.html#image-attributess"},z((()=>Z(t.appendToBody))));const{t:n}=g(),s=y("image"),o=ue(),r=k(!1),i=k(!0),c=k(0),u=k(0),m=k(!1),b=k(),w=k();let h,x;const O=z((()=>o.value.style)),A=z((()=>{const{fit:e}=t;return p&&e?{objectFit:e}:{}})),S=z((()=>{const{previewSrcList:e}=t;return Array.isArray(e)&&e.length>0})),V=z((()=>t.appendToBody||t.previewTeleported)),E=z((()=>{const{previewSrcList:e,initialIndex:a}=t;let l=a;return a>e.length-1&&(l=0),l})),P=()=>{if(!p)return;i.value=!0,r.value=!1;const e=new Image,l=t.src;e.addEventListener("load",(a=>{l===t.src&&function(e,a){c.value=a.width,u.value=a.height,i.value=!1,r.value=!1}(0,e)})),e.addEventListener("error",(e=>{var n;l===t.src&&(n=e,i.value=!1,r.value=!0,a("error",n))})),Object.entries(o.value).forEach((([a,t])=>{"onload"!==a.toLowerCase()&&e.setAttribute(a,t)})),e.src=l};function Y(){te(b.value,w.value)&&(P(),F())}const $=le(Y,200);async function D(){var e;if(!p)return;await I();const{scrollContainer:a}=t;K(a)?w.value=a:ee(a)&&""!==a?w.value=null!=(e=document.querySelector(a))?e:void 0:b.value&&(w.value=ae(b.value)),w.value&&(h=U(w,"scroll",$),setTimeout((()=>Y()),100))}function F(){p&&w.value&&$&&(h(),w.value=void 0)}function H(e){if(e.ctrlKey)return e.deltaY<0||e.deltaY>0?(e.preventDefault(),!1):void 0}function W(){S.value&&(x=U("wheel",H,{passive:!1}),l=document.body.style.overflow,document.body.style.overflow="hidden",m.value=!0)}function Q(){null==x||x(),document.body.style.overflow=l,m.value=!1,a("close")}function G(e){a("switch",e)}return C((()=>t.src),(()=>{t.lazy?(i.value=!0,r.value=!1,F(),D()):P()})),_((()=>{t.lazy?D():P()})),(e,a)=>(v(),d("div",{ref_key:"container",ref:b,class:L([j(s).b(),e.$attrs.class]),style:R(j(O))},[i.value?X(e.$slots,"placeholder",{key:0},(()=>[f("div",{class:L(j(s).e("placeholder"))},null,2)])):r.value?X(e.$slots,"error",{key:1},(()=>[f("div",{class:L(j(s).e("error"))},q(j(n)("el.image.error")),3)])):(v(),d("img",J({key:2},j(o),{src:e.src,style:j(A),class:[j(s).e("inner"),j(S)?j(s).e("preview"):""],onClick:W}),null,16,Ee)),j(S)?(v(),d(M,{key:3},[m.value?(v(),T(j(Se),{key:0,"z-index":e.zIndex,"initial-index":j(E),infinite:e.infinite,"url-list":e.previewSrcList,"hide-on-click-modal":e.hideOnClickModal,teleported:j(V),"close-on-press-escape":e.closeOnPressEscape,onClose:Q,onSwitch:G},{default:B((()=>[e.$slots.viewer?(v(),d("div",Me,[X(e.$slots,"viewer")])):N("v-if",!0)])),_:3},8,["z-index","initial-index","infinite","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):N("v-if",!0)],2112)):N("v-if",!0)],6))}})),[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]));export{Pe as E};
