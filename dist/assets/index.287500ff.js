var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{a4 as i,ay as n,U as d,a2 as u,c4 as c,W as p,X as m,I as f,aE as g,aB as b,az as v,A as h,dv as y,r as w,k as x,x as _,b1 as V,bo as I,bD as k,bp as A,a1 as C,cb as T,c0 as j,dB as P,ci as U,Q as D,dC as q,aw as z,D as F,c3 as B,aH as E,V as L,b3 as O,bn as S}from"./el-button.0a4ba32a.js";import{_ as K}from"./d-dialog.ed95f2b9.js";import{E as M}from"./el-input.b3ba137c.js";import{E as H}from"./el-dialog.4b8a03dc.js";import"./el-overlay.ebdea840.js";import{E as N,a as Q}from"./el-form-item.785a6e2e.js";import{E as R}from"./el-radio.cee63c3c.js";import{u as W,m as X}from"./main.858372aa.js";import"./typescript.72bf8adc.js";import"./index.8dc67c0c.js";import"./_baseClone.a466ea06.js";import"./_Uint8Array.d6bc81f7.js";import"./isEqual.6fce44d5.js";import"./_baseIsEqual.220044e7.js";var G=i({name:"Lock"});const J={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Y=u("path",{fill:"currentColor",d:"M224 448a32 32 0 0 0-32 32v384a32 32 0 0 0 32 32h576a32 32 0 0 0 32-32V480a32 32 0 0 0-32-32H224zm0-64h576a96 96 0 0 1 96 96v384a96 96 0 0 1-96 96H224a96 96 0 0 1-96-96V480a96 96 0 0 1 96-96z"},null,-1),Z=u("path",{fill:"currentColor",d:"M512 544a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V576a32 32 0 0 1 32-32zm192-160v-64a192 192 0 1 0-384 0v64h384zM512 64a256 256 0 0 1 256 256v128H256V320A256 256 0 0 1 512 64z"},null,-1);G.render=function(e,a,l,t,o,s){return n(),d("svg",J,[Y,Z])},G.__file="packages/components/Lock.vue";var $=G,ee=i({name:"User"});const ae={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},le=u("path",{fill:"currentColor",d:"M512 512a192 192 0 1 0 0-384 192 192 0 0 0 0 384zm0 64a256 256 0 1 1 0-512 256 256 0 0 1 0 512zm320 320v-96a96 96 0 0 0-96-96H288a96 96 0 0 0-96 96v96a32 32 0 1 1-64 0v-96a160 160 0 0 1 160-160h448a160 160 0 0 1 160 160v96a32 32 0 1 1-64 0z"},null,-1);ee.render=function(e,a,l,t,o,s){return n(),d("svg",ae,[le])},ee.__file="packages/components/User.vue";var te=ee;const oe="function"==typeof btoa,se="function"==typeof Buffer;"function"==typeof TextDecoder&&new TextDecoder;const re="function"==typeof TextEncoder?new TextEncoder:void 0,ie=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=");(e=>{let a={};ie.forEach(((e,l)=>a[e]=l))})();const ne=String.fromCharCode.bind(String);"function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array);const de=oe?e=>btoa(e):se?e=>Buffer.from(e,"binary").toString("base64"):e=>{let a,l,t,o,s="";const r=e.length%3;for(let i=0;i<e.length;){if((l=e.charCodeAt(i++))>255||(t=e.charCodeAt(i++))>255||(o=e.charCodeAt(i++))>255)throw new TypeError("invalid character found");a=l<<16|t<<8|o,s+=ie[a>>18&63]+ie[a>>12&63]+ie[a>>6&63]+ie[63&a]}return r?s.slice(0,r-3)+"===".substring(r):s},ue=se?e=>Buffer.from(e).toString("base64"):e=>{let a=[];for(let l=0,t=e.length;l<t;l+=4096)a.push(ne.apply(null,e.subarray(l,l+4096)));return de(a.join(""))},ce=e=>{if(e.length<2)return(a=e.charCodeAt(0))<128?e:a<2048?ne(192|a>>>6)+ne(128|63&a):ne(224|a>>>12&15)+ne(128|a>>>6&63)+ne(128|63&a);var a=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return ne(240|a>>>18&7)+ne(128|a>>>12&63)+ne(128|a>>>6&63)+ne(128|63&a)},pe=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,me=se?e=>Buffer.from(e,"utf8").toString("base64"):re?e=>ue(re.encode(e)):e=>de(e.replace(pe,ce)),fe=(e,a=!1)=>a?(e=>e.replace(/=/g,"").replace(/[+\/]/g,(e=>"+"==e?"-":"_")))(me(e)):me(e);const ge={class:"d-flex-between login-third"},be=(e=>(b("data-v-79b59598"),e=e(),v(),e))((()=>m("div",null,"第三方账号登录",-1))),ve={class:"d-flex"},he=["href","onClick"],ye=["src"];var we=c({emits:["loginThird"],setup(e,{emit:a}){const l=[{url:"https://api.weibo.com/oauth2/authorize?client_id=3805380913&redirect_uri=https://www.codelife.cc/logincb&response_type=code&state=&scope=all",icon:"weibo"},{url:"https://graph.qq.com/oauth2.0/show?which=Login&display=pc&response_type=code&client_id=101983660&redirect_uri=https%3A%2F%2Fwww.codelife.cc%2Flogincb&state=qq",icon:"qq"},{url:"https://github.com/login/oauth/authorize?client_id=930860aee1b7c1ce56ee&scope=user",icon:"github"}];return(e,t)=>(n(),p("div",ge,[be,m("div",ve,[(n(),p(f,null,g(l,(e=>m("span",{href:e.url,key:e.icon,onClick:l=>(e=>{window.open(e.url,"_blank","width=800,height=500"),window.addEventListener("message",(e=>{let l=e.data||{};a("loginThird",l)}),!1)})(e)},[m("img",{style:{width:"24px",height:"24px"},src:`./login/${e.icon}.svg`},null,8,ye)],8,he))),64))])]))}},[["__scopeId","data-v-79b59598"]]);const xe=e=>(b("data-v-59dce5ef"),e=e(),v(),e),_e=[xe((()=>m("span",{class:"brid-body"},null,-1))),xe((()=>m("span",{class:"brid-claw left"},null,-1))),xe((()=>m("span",{class:"brid-claw right"},null,-1)))];var Ve=c({props:{inputPass:{type:Boolean,defautl:!1}},setup(e){const a=e;return(e,l)=>(n(),p("div",null,[m("div",{class:h(["login-bird",{password:a.inputPass}])},_e,2)]))}},[["__scopeId","data-v-59dce5ef"]]);const Ie=e=>(b("data-v-703458ac"),e=e(),v(),e),ke=Ie((()=>m("div",{class:"ar",style:{margin:"-15px 0 10px 0"}},[m("a",{class:"d-main f12",target:"_blank",href:"https://codelife.cc/account/pass?type=find"},"忘记密码")],-1))),Ae=C("立即登录"),Ce=Ie((()=>m("div",null,[m("h2",{class:"ac f18 mb10 pt30"},"选择账号数据")],-1))),Te=Ie((()=>m("p",{class:"f12 d-sub ac"},"检测到云端数据和本地数据不一致，请选择使用其中某一项数据",-1))),je={style:{padding:"20px 40px 40px"}},Pe=C("使用本地数据"),Ue=C("使用云端数据"),De={class:"ac mt30"},qe=C("确定");var ze=c({setup(e){const a=W(),l=y(),t=w({email:"",password:""}),o=w({loading:!1,userInfo:{},selectDataVisible:!1,dataActive:2,isInputPass:!1}),s=x(null),r=()=>{o.loading=!0;let e={};e.email=t.email,e.from="itab",e.password=fe(t.password),e.t=(new Date).getTime(),T.userLogin(e).then((e=>{200==e.code&&i(e)})).finally((()=>{o.loading=!1}))};function i(e){if(o.userInfo=e.data||{},!e.token)return;o.userInfo.token=e.token;let t=!1;o.userInfo.upTime&&(t=!0);for(let a in o.userInfo.itabAsyncTime)1!=o.userInfo.itabAsyncTime[a]&&(t=!0);t?(a.loginInfo.visible=!0,o.selectDataVisible=!0):(l.value=o.userInfo,j.set("token",o.userInfo.token),a.loginInfo.visible=!1)}function d(){l.value=o.userInfo,j.set("token",o.userInfo.token),2==o.dataActive?P(null,o.userInfo.itabAsyncTime):U(null),o.selectDataVisible=!1,a.loginInfo.visible=!1}return(e,a)=>(n(),p("div",null,[u(Ve,{inputPass:_(o).isInputPass},null,8,["inputPass"]),u(_(Q),{onSubmit:a[4]||(a[4]=A((()=>{}),["prevent"])),size:"large",model:_(t),ref_key:"refLoginForm",ref:s,"label-position":"right"},{default:V((()=>[u(_(N),{prop:"email",rules:{required:!0,type:"email",message:"邮箱格式不正确"}},{default:V((()=>[u(_(M),{"prefix-icon":_(te),maxlength:"40",modelValue:_(t).email,"onUpdate:modelValue":a[0]||(a[0]=e=>_(t).email=e),placeholder:"请输入邮箱"},null,8,["prefix-icon","modelValue"])])),_:1}),u(_(N),{prop:"password",rules:{required:!0,message:"密码不能为空"}},{default:V((()=>[u(_(M),{onKeydown:I(r,["enter"]),maxlength:"20","show-password":"","prefix-icon":_($),type:"password",modelValue:_(t).password,"onUpdate:modelValue":a[1]||(a[1]=e=>_(t).password=e),onFocus:a[2]||(a[2]=e=>_(o).isInputPass=!0),onBlur:a[3]||(a[3]=e=>_(o).isInputPass=!1),placeholder:"请输入6-18位密码"},null,8,["onKeydown","prefix-icon","modelValue"])])),_:1}),ke,u(_(k),{round:"",onClick:r,type:"primary",class:"mb20 wfull",loading:_(o).loading},{default:V((()=>[Ae])),_:1},8,["loading"])])),_:1},8,["model"]),u(we,{onLoginThird:i}),u(_(H),{"append-to-body":!0,width:"400px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,modelValue:_(o).selectDataVisible,"onUpdate:modelValue":a[7]||(a[7]=e=>_(o).selectDataVisible=e)},{default:V((()=>[Ce,Te,m("div",je,[m("p",null,[u(_(R),{modelValue:_(o).dataActive,"onUpdate:modelValue":a[5]||(a[5]=e=>_(o).dataActive=e),label:1},{default:V((()=>[Pe])),_:1},8,["modelValue"])]),m("p",null,[u(_(R),{modelValue:_(o).dataActive,"onUpdate:modelValue":a[6]||(a[6]=e=>_(o).dataActive=e),label:2},{default:V((()=>[Ue])),_:1},8,["modelValue"])]),m("p",De,[u(_(k),{onClick:d,class:"wfull",type:"primary"},{default:V((()=>[qe])),_:1})])])])),_:1},8,["modelValue"])]))}},[["__scopeId","data-v-703458ac"]]);const Fe={class:"d-flex-between wfull"},Be=C("立即注册 "),Ee={setup(e){const i=y(),d=W(),c=w({timer:null,loading:!1,timerText:"获取验证码",setp:0,isInputPass:!1}),f=w({email:"",username:"",password:"",verifyKey:"",source:X()}),g=x(null);const b=D((()=>!q(f.email)));D((()=>!q(f.email)));const v=()=>{q(f.email)?(c.timerText=10,c.timer=setInterval((()=>{c.timerText--,c.timerText<=0&&(clearInterval(c.timer),c.timerText="获取验证码")}),1e3),T.userSendVerifyCode({email:f.email}).then((e=>{B.success("验证码发送成功")}))):B.warning("请输入正确的邮箱")};function h(){g.value.validate((e=>{if(!e)return;c.loading=!0;let n=(u=((e,a)=>{for(var l in a||(a={}))o.call(a,l)&&r(e,l,a[l]);if(t)for(var l of t(a))s.call(a,l)&&r(e,l,a[l]);return e})({},f),p={password:fe(f.password)},a(u,l(p)));var u,p;n.t=(new Date).getTime(),T.userRegistry(n).then((e=>{let a=e.data||{};i.value=a,j.set("token",e.token),B.success("注册成功"),d.loginInfo.visible=!1})).finally((()=>{c.loading=!1}))}))}return z((()=>{clearInterval(c.timer)})),(e,a)=>(n(),p("div",null,[u(Ve,{inputPass:_(c).isInputPass},null,8,["inputPass"]),u(_(Q),{onSubmit:a[6]||(a[6]=A((()=>{}),["prevent"])),size:"default",model:_(f),ref_key:"refLoginForm",ref:g,"label-position":"right"},{default:V((()=>[u(_(N),{prop:"email",rules:{required:!0,type:"email",message:"邮箱格式不正确"}},{default:V((()=>[m("div",Fe,[u(_(M),{autocomplete:"off",maxlength:"40",modelValue:_(f).email,"onUpdate:modelValue":a[0]||(a[0]=e=>_(f).email=e),modelModifiers:{trim:!0},placeholder:"请输入邮箱"},null,8,["modelValue"]),u(_(k),{style:{width:"90px"},type:"primary",class:"ml5",disabled:_(b)||"获取验证码"!=_(c).timerText,onClick:v},{default:V((()=>[C(F(_(c).timerText),1)])),_:1},8,["disabled"])])])),_:1}),u(_(N),{prop:"verifyKey",rules:{required:!0,message:"验证码不能为空"}},{default:V((()=>[u(_(M),{autocomplete:"off",maxlength:"6",modelValue:_(f).verifyKey,"onUpdate:modelValue":a[1]||(a[1]=e=>_(f).verifyKey=e),placeholder:"请输入6位邮箱验证码"},null,8,["modelValue"])])),_:1}),u(_(N),{prop:"username",rules:{required:!0,message:"请输入用户名"}},{default:V((()=>[u(_(M),{autocomplete:"off",maxlength:"18",modelValue:_(f).username,"onUpdate:modelValue":a[2]||(a[2]=e=>_(f).username=e),modelModifiers:{trim:!0},placeholder:"请输入用户名"},null,8,["modelValue"])])),_:1}),u(_(N),{prop:"password",rules:{required:!0,message:"密码不能为空"}},{default:V((()=>[u(_(M),{autocomplete:"off",maxlength:"20","show-password":"",type:"password",onFocus:a[3]||(a[3]=e=>_(c).isInputPass=!0),onBlur:a[4]||(a[4]=e=>_(c).isInputPass=!1),modelValue:_(f).password,"onUpdate:modelValue":a[5]||(a[5]=e=>_(f).password=e),placeholder:"请输入8-18密码"},null,8,["modelValue"])])),_:1}),u(_(k),{size:"large",round:"",loading:_(c).loading,onClick:h,type:"primary",class:"wfull"},{default:V((()=>[Be])),_:1},8,["loading"])])),_:1},8,["model"])]))}};const Le={class:"app-login hfull"},Oe=(e=>(b("data-v-177b7be9"),e=e(),v(),e))((()=>m("h2",{class:"b f18 ac"},"欢迎使用iTab",-1))),Se={class:"login-tip ac"},Ke={key:0,class:"mt5"},Me={class:"pl30 pr30 mb30"},He={key:0,class:"ac"},Ne=C(" 还没有账号？ "),Qe=C("立即注册"),Re={key:1,class:"ac"},We=C(" 已有账号？ "),Xe=C("立即登录");var Ge=c({setup(e){const a=W(),l=w({loading:!1,activeName:"email"}),t=D((()=>a.loginInfo||{})),o=e=>{a.setLoginInfo(e)};return(e,a)=>{const s=E("loading");return n(),d(K,{"close-on-press-escape":!1,"close-on-click-modal":!1,fullscreenBtn:!1,width:"420px",height:"440px",modelValue:_(t).visible,"onUpdate:modelValue":a[2]||(a[2]=e=>_(t).visible=e)},{default:V((()=>[m("div",Le,[Oe,m("div",Se,["firefox"==_(X)()?(n(),p("p",Ke,"火狐暂不支持第三方登陆")):L("",!0)]),m("div",Me,[O(u(ze,null,null,512),[[S,"login"==_(t).type]]),O(u(Ee,null,null,512),[[S,"reg"==_(t).type]]),"login"==_(t).type?O((n(),p("div",He,[Ne,u(_(k),{type:"text",onClick:a[0]||(a[0]=e=>o("reg"))},{default:V((()=>[Qe])),_:1})])),[[s,_(l).loading]]):L("",!0),"reg"==_(t).type?(n(),p("div",Re,[We,u(_(k),{type:"text",onClick:a[1]||(a[1]=e=>o("login"))},{default:V((()=>[Xe])),_:1})])):L("",!0)])])])),_:1},8,["modelValue"])}}},[["__scopeId","data-v-177b7be9"]]);export{Ge as default};
