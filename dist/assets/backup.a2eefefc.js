import{a}from"./index.6363f97d.js";import{c4 as e,dv as l,r as s,ay as t,W as o,X as i,x as n,D as r,V as c,a2 as u,b1 as p,U as d,bD as b,I as m,aE as f,a1 as k,aB as g,az as x,c0 as V,c3 as v,ci as j,dB as C,dU as y,bx as h}from"./el-button.0a4ba32a.js";import{a as Y}from"./timeFormat.9fb4ebd1.js";import{E as _}from"./el-upload.57856de0.js";import{b as D,u as w,a9 as E}from"./main.858372aa.js";import{a as U,E as z}from"./el-checkbox-group.f5e56890.js";import{E as M}from"./el-dialog.4b8a03dc.js";import"./el-overlay.ebdea840.js";import T from"./hisBackup.214b3dea.js";import"./el-input.b3ba137c.js";import"./typescript.72bf8adc.js";import"./zoom-in.dd934e7d.js";import"./index.c956e740.js";import"./validator.053f84bf.js";import"./index.8dc67c0c.js";import"./index.1c036255.js";import"./index.065a2d57.js";import"./event.0bae16b8.js";const A=a=>(g("data-v-e6af4ae0"),a=a(),x(),a),B=[A((()=>i("a",null,"同步到本地",-1)))],I={key:0,class:"mt20 setting-li-sub"},F=[A((()=>i("a",null,"立即备份",-1)))],H=[A((()=>i("a",null,"管理历史备份",-1)))],J=A((()=>i("br",null,null,-1))),N=[A((()=>i("a",null,"导出数据",-1)))],O=A((()=>i("a",null,"从本地恢复",-1))),S={class:"p20 ac"},L={class:"ac mb20"},R=k("取消"),W=k("导出");var X=e({setup(e){D();const g=l(),x=w(),A=[{label:"设置",value:"baseConfig"},{label:"图标",value:"navConfig"},{label:"备忘录",value:"notes"},{label:"待办",value:"todo"}];function X(){q()&&(G.backupVisible=!0)}function q(){let a=V.get("token");return a||(x.setLoginInfo("login"),v.warning("请登录后使用同步功能")),!!a}const G=s({backupVisible:!1,exportVisible:!1,exportCheck:["baseConfig","navConfig","notes","todo"]});function K(a){if(!q())return;const e=E.service({lock:!0,text:"数据同步中",background:"rgba(0, 0, 0, 0.7)"});setTimeout((()=>{e.close()}),500),"backup"==a?j(null,100,"manua"):C()}const P=a=>{var e=new FileReader;e.readAsText(a.raw),e.onload=()=>{const a=JSON.parse(e.result);a?(y(a),v.success("恢复成功")):v.error("数据格式可能不正确")}},Q=()=>{let e={};G.exportCheck.forEach((a=>{e[a]=V.get(a)||[]})),a(JSON.stringify(e),h().format("YYYYMMDD")+".itabdata")};return(a,e)=>(t(),o("span",null,[i("p",{class:"setting-li",onClick:e[0]||(e[0]=a=>K("async"))},B),n(g).itabAsyncTime?(t(),o("h2",I,"上次备份: "+r(n(Y)(n(g).itabAsyncTime.baseConfig,"YYYY-MM-DD HH:mm:ss")),1)):c("",!0),i("p",{class:"setting-li",onClick:e[1]||(e[1]=a=>K("backup"))},F),i("p",{class:"setting-li",onClick:X},H),J,i("p",{class:"setting-li",onClick:e[2]||(e[2]=a=>n(G).exportVisible=!0)},N),u(n(_),{action:"/","show-file-list":!1,multiple:!1,"auto-upload":!1,"on-change":P,class:"backup-import setting-li"},{default:p((()=>[O])),_:1}),n(G).backupVisible?(t(),d(T,{key:1,modelValue:n(G).backupVisible,"onUpdate:modelValue":e[3]||(e[3]=a=>n(G).backupVisible=a)},null,8,["modelValue"])):c("",!0),u(n(M),{modelValue:n(G).exportVisible,"onUpdate:modelValue":e[6]||(e[6]=a=>n(G).exportVisible=a),title:"选择导出内容",width:"600px"},{footer:p((()=>[i("div",L,[u(n(b),{size:"default",onClick:e[5]||(e[5]=a=>n(G).exportVisible=!1)},{default:p((()=>[R])),_:1}),u(n(b),{size:"default",class:"ml10",type:"primary",onClick:Q},{default:p((()=>[W])),_:1})])])),default:p((()=>[i("div",S,[u(n(U),{modelValue:n(G).exportCheck,"onUpdate:modelValue":e[4]||(e[4]=a=>n(G).exportCheck=a)},{default:p((()=>[(t(),o(m,null,f(A,(a=>u(n(z),{key:a.value,label:a.value},{default:p((()=>[k(r(a.label),1)])),_:2},1032,["label"]))),64))])),_:1},8,["modelValue"])])])),_:1},8,["modelValue"])]))}},[["__scopeId","data-v-e6af4ae0"]]);export{X as default};
